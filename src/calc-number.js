CalcNumber.numberWidth = 50;
CalcNumber.commaWidth = 24;

CalcNumber.createSvgElement = function(type) {
    return document.createElementNS('http://www.w3.org/2000/svg', type);
}

// set number wrapper
CalcNumber.createNumberG = function() {
    var g = CalcNumber.createSvgElement('g');
    g.setAttribute('stroke', 'none');
    g.setAttribute('stroke-width', '1');
    g.setAttribute('fill', 'none');
    g.setAttribute('fill-rule', 'evenodd');
    g.setAttribute('transform', 'translate(' + (arguments.length > 1 ?  arguments[1] :  arguments[0]) + ', -823.000000)');
    let options = arguments[0];
    options && options.length && options.forEach(function(item) {
        g.setAttribute(item.key, item.value);
    })
    return g;
}

CalcNumber.createComma = function(color, offset) {
    var c = CalcNumber.createSvgElement('polygon');
    c.setAttribute('points', '452.181818 926.818182 447.090909 931.545455 442.727273 926.818182 443.909091 914.181818 453.363636 914.181818');
    c.setAttribute('fill', color);
    return c;
}

CalcNumber.createNumber = function(path, color) {
    var n = CalcNumber.createSvgElement('path');
    n.setAttribute('d', path);
    n.setAttribute('fill', color);
    return n;
}

CalcNumber[','] = function(color, offset) {
    var comma = CalcNumber.createNumberG([
        {
            key: 'transform',
            value: 'translate(' + (520 + offset) + ', -858.000000)'
        }
    ], offset);
    comma.appendChild(CalcNumber.createComma(color));
    return comma;
}

CalcNumber['0'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M976.363636,823.363636 L966.090909,832.909091 L948.272727,832.909091 L939.636364,823.363636 L976.363636,823.363636 Z M970.818182,887 L934.090909,887 L944.363636,877.545455 L962.181818,877.545455 L970.818182,887 Z M943.818182,862.909091 L942.727273,875.727273 L932.454545,885.181818 L934.545455,860.545455 L938.454545,857 L943.818182,862.909091 Z M935.545455,849.818182 L937.636364,825.181818 L946.272727,834.636364 L945.181818,847.454545 L938.727273,853.454545 L935.545455,849.818182 Z M974.818182,860.545455 L972.727273,885.181818 L964.090909,875.727273 L965.181818,862.909091 L971.636364,857 L974.818182,860.545455 Z M966.545455,847.454545 L967.636364,834.636364 L977.909091,825.181818 L975.818182,849.818182 L971.909091,853.454545 L966.545455,847.454545 Z', color));
    return n;
}

CalcNumber['1'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M974.818182,860.545455 L972.727273,885.181818 L964.090909,875.727273 L965.181818,862.909091 L971.636364,857 L974.818182,860.545455 Z M966.545455,847.454545 L967.636364,834.636364 L977.909091,825.181818 L975.818182,849.818182 L971.909091,853.454545 L966.545455,847.454545 Z', color));
    return n;
}

CalcNumber['2'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M976.363636,823.363636 L966.090909,832.909091 L948.272727,832.909091 L939.636364,823.363636 L976.363636,823.363636 Z M970.818182,887 L934.090909,887 L944.363636,877.545455 L962.181818,877.545455 L970.818182,887 Z M943.818182,862.909091 L942.727273,875.727273 L932.454545,885.181818 L934.545455,860.545455 L938.454545,857 L943.818182,862.909091 Z M966.545455,847.454545 L967.636364,834.636364 L977.909091,825.181818 L975.818182,849.818182 L971.909091,853.454545 L966.545455,847.454545 Z M965.727273,850.454545 L970.090909,855.181818 L964.909091,859.909091 L944.727273,859.909091 L940.454545,855.181818 L945.545455,850.454545 L965.727273,850.454545 Z', color));
    return n;
}

CalcNumber['3'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M976.363636,823.363636 L966.090909,832.909091 L948.272727,832.909091 L939.636364,823.363636 L976.363636,823.363636 Z M970.818182,887 L934.090909,887 L944.363636,877.545455 L962.181818,877.545455 L970.818182,887 Z M974.818182,860.545455 L972.727273,885.181818 L964.090909,875.727273 L965.181818,862.909091 L971.636364,857 L974.818182,860.545455 Z M966.545455,847.454545 L967.636364,834.636364 L977.909091,825.181818 L975.818182,849.818182 L971.909091,853.454545 L966.545455,847.454545 Z M965.727273,850.454545 L970.090909,855.181818 L964.909091,859.909091 L944.727273,859.909091 L940.454545,855.181818 L945.545455,850.454545 L965.727273,850.454545 Z', color));
    return n;
}

CalcNumber['4'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M935.545455,849.818182 L937.636364,825.181818 L946.272727,834.636364 L945.181818,847.454545 L938.727273,853.454545 L935.545455,849.818182 Z M974.818182,860.545455 L972.727273,885.181818 L964.090909,875.727273 L965.181818,862.909091 L971.636364,857 L974.818182,860.545455 Z M966.545455,847.454545 L967.636364,834.636364 L977.909091,825.181818 L975.818182,849.818182 L971.909091,853.454545 L966.545455,847.454545 Z M965.727273,850.454545 L970.090909,855.181818 L964.909091,859.909091 L944.727273,859.909091 L940.454545,855.181818 L945.545455,850.454545 L965.727273,850.454545 Z', color));
    return n;
}

CalcNumber['5'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M976.363636,823.363636 L966.090909,832.909091 L948.272727,832.909091 L939.636364,823.363636 L976.363636,823.363636 Z M970.818182,887 L934.090909,887 L944.363636,877.545455 L962.181818,877.545455 L970.818182,887 Z M935.545455,849.818182 L937.636364,825.181818 L946.272727,834.636364 L945.181818,847.454545 L938.727273,853.454545 L935.545455,849.818182 Z M974.818182,860.545455 L972.727273,885.181818 L964.090909,875.727273 L965.181818,862.909091 L971.636364,857 L974.818182,860.545455 Z M965.727273,850.454545 L970.090909,855.181818 L964.909091,859.909091 L944.727273,859.909091 L940.454545,855.181818 L945.545455,850.454545 L965.727273,850.454545 Z', color));
    return n;
}

CalcNumber['6'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M976.363636,823.363636 L966.090909,832.909091 L948.272727,832.909091 L939.636364,823.363636 L976.363636,823.363636 Z M970.818182,887 L934.090909,887 L944.363636,877.545455 L962.181818,877.545455 L970.818182,887 Z M943.818182,862.909091 L942.727273,875.727273 L932.454545,885.181818 L934.545455,860.545455 L938.454545,857 L943.818182,862.909091 Z M935.545455,849.818182 L937.636364,825.181818 L946.272727,834.636364 L945.181818,847.454545 L938.727273,853.454545 L935.545455,849.818182 Z M974.818182,860.545455 L972.727273,885.181818 L964.090909,875.727273 L965.181818,862.909091 L971.636364,857 L974.818182,860.545455 Z M965.727273,850.454545 L970.090909,855.181818 L964.909091,859.909091 L944.727273,859.909091 L940.454545,855.181818 L945.545455,850.454545 L965.727273,850.454545 Z', color));
    return n;
}

CalcNumber['7'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M976.363636,823.363636 L966.090909,832.909091 L948.272727,832.909091 L939.636364,823.363636 L976.363636,823.363636 Z M974.818182,860.545455 L972.727273,885.181818 L964.090909,875.727273 L965.181818,862.909091 L971.636364,857 L974.818182,860.545455 Z M966.545455,847.454545 L967.636364,834.636364 L977.909091,825.181818 L975.818182,849.818182 L971.909091,853.454545 L966.545455,847.454545 Z', color));
    return n;
}

CalcNumber['8'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M976.363636,823.363636 L966.090909,832.909091 L948.272727,832.909091 L939.636364,823.363636 L976.363636,823.363636 Z M970.818182,887 L934.090909,887 L944.363636,877.545455 L962.181818,877.545455 L970.818182,887 Z M943.818182,862.909091 L942.727273,875.727273 L932.454545,885.181818 L934.545455,860.545455 L938.454545,857 L943.818182,862.909091 Z M935.545455,849.818182 L937.636364,825.181818 L946.272727,834.636364 L945.181818,847.454545 L938.727273,853.454545 L935.545455,849.818182 Z M974.818182,860.545455 L972.727273,885.181818 L964.090909,875.727273 L965.181818,862.909091 L971.636364,857 L974.818182,860.545455 Z M966.545455,847.454545 L967.636364,834.636364 L977.909091,825.181818 L975.818182,849.818182 L971.909091,853.454545 L966.545455,847.454545 Z M965.727273,850.454545 L970.090909,855.181818 L964.909091,859.909091 L944.727273,859.909091 L940.454545,855.181818 L945.545455,850.454545 L965.727273,850.454545 Z', color));
    return n;
}

CalcNumber['9'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M976.363636,823.363636 L966.090909,832.909091 L948.272727,832.909091 L939.636364,823.363636 L976.363636,823.363636 Z M970.818182,887 L934.090909,887 L944.363636,877.545455 L962.181818,877.545455 L970.818182,887 Z M935.545455,849.818182 L937.636364,825.181818 L946.272727,834.636364 L945.181818,847.454545 L938.727273,853.454545 L935.545455,849.818182 Z M974.818182,860.545455 L972.727273,885.181818 L964.090909,875.727273 L965.181818,862.909091 L971.636364,857 L974.818182,860.545455 Z M966.545455,847.454545 L967.636364,834.636364 L977.909091,825.181818 L975.818182,849.818182 L971.909091,853.454545 L966.545455,847.454545 Z M965.727273,850.454545 L970.090909,855.181818 L964.909091,859.909091 L944.727273,859.909091 L940.454545,855.181818 L945.545455,850.454545 L965.727273,850.454545 Z', color));
    return n;
}

CalcNumber['-'] = function(color, offset) {
    var n = CalcNumber.createNumberG(offset);
    n.appendChild(CalcNumber.createNumber('M965.727273,850.454545 L970.090909,855.181818 L964.909091,859.909091 L944.727273,859.909091 L940.454545,855.181818 L945.545455,850.454545 L965.727273,850.454545 Z', color));
    return n;
}

CalcNumber.init = function(options) {
    var svgContainer = CalcNumber.createSvgElement('svg');
    svgContainer.setAttribute('width', options.width);
    svgContainer.setAttribute('height', options.height);
    svgContainer.setAttribute('viewBox', "0 0 " + options.viewBoxWidth + " 74");
    svgContainer.setAttribute('preserveAspectRatio', "xMidYMin meet");
    return svgContainer;
}

function CalcNumber(container, options, value) {
    var svgContainer = CalcNumber.init(options);

    let offset = -1150; // TODO
    String(value).split('').reverse().reduce((obj, v, i) => {
        obj.push(v);
        if ((i + 1) % 3 === 0) {
          obj.push(',');
        }
        return obj;
    }, []).reverse()
    .reduce((obj, v, i) => {
        if (v === ',') {
            if (i === 0) return obj;
            offset = offset + CalcNumber.commaWidth
        } else {
            offset = offset + CalcNumber.numberWidth
        }
        obj.push({v: v, x: offset});
        return obj;
      }, []).forEach(item => {
          console.log(item.v);
          console.log(item.x);
        svgContainer.appendChild(CalcNumber[item.v](options.color, item.x));
      });
 
    container.appendChild(svgContainer);
}